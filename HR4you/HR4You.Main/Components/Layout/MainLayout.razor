@using Microsoft.IdentityModel.Tokens
@inherits LayoutComponentBase

<body>
<div class="page min-h-[100vh] flex flex-row flex-nowrap">
    <div class="sidebar">
        <NavMenu/>
    </div>

    <main>
            

        <div class="content">
            <div class="user-display">
                <div class="user-info">
                    <p class="user-name">@_userName</p>
            
                </div>
                <div class="user-actions">
            
                    <pö class="logout-text">Log out</pö>
                </div>
            </div>
            @Body
        </div>
    </main>
</div>
</body>

@code
{
    private string _userName = "test";//todo get to render + make logout possible !

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await Load();
    }

    
    private async Task Load()
    {
        var storedItem = await LocalStorage.GetItem(ILocalStorageHandler.UserStorageName);
        if (storedItem.IsNullOrEmpty())
        {
            return;
        }

        _userName = storedItem.FromJson()!.UserName!;
    }

}
